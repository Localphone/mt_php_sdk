<?php
/*
 * MagicTelecomAPILib
 *
 * This file was automatically generated by APIMATIC BETA v2.0 on 12/08/2015
 */

namespace MagicTelecomAPILib;

class CustomAuthUtility {

    public static $username = 'admin@magictelecom.com';
    public static $apiToken = 'thisismysupperduppersecrettoken';

    /**
    * Appends the necessary Custom Authentication credentials for making this authorized call
    * @param HttpRequest $request The out going request to access the resource
    */
    public static function appendCustomAuthParams($request)
    {
        $request->__set('headers', array(
            "X-WSSE"        => self::generateWSSEHeader(self::$username, self::$apiToken),
            "HTTP_ACCEPT"   => "application/json",
            "CONTENT_TYPE"  => "application/json",
            "ACCEPT"        => "application/json",
        ));
    }

     public static function generateWSSEHeader($strUsername, $strPassword)
    {
        $strNonce = sha1(uniqid(null, true).time());
        $objTimestamp = new \DateTime();
        $strTimestamp = $objTimestamp->format(\DateTime::ATOM);

        $strDigest = base64_encode(sha1($strNonce.$strTimestamp.$strPassword, true));

        $strHeader = 'UsernameToken Username="'.$strUsername.'", PasswordDigest="'.$strDigest.'", Nonce="'.$strNonce.'", Created="'.$strTimestamp.'"';

        return $strHeader;
    }
}